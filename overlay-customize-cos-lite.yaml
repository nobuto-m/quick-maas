bundle: kubernetes
applications:
  # LP: #2041173
  cos-configuration-ceph:
    charm: cos-configuration-k8s
    #channel: stable
    channel: latest/edge
    scale: 1
    options:
      # https://github.com/canonical/cos-configuration-k8s-operator/issues/75
      git_repo: https://github.com/nobuto-m/ceph.git
      git_branch: cos-configuration
      grafana_dashboards_path: monitoring/ceph-mixin/dashboards_out/
      loki_alert_rules_path: ''
      prometheus_alert_rules_path: ''
  # LP: #2041500
  prometheus-scrape-config-ceph:
    charm: prometheus-scrape-config-k8s
    #channel: stable
    channel: latest/edge
    scale: 1
    options:
      # https://github.com/canonical/prometheus-k8s-operator/issues/544
      # https://docs.ceph.com/en/latest/mgr/prometheus/#confval-mgr-prometheus-scrape_interval
      scrape_interval: 15s
    offers:
      prometheus-scrape-config-ceph:
        endpoints:
        - configurable-scrape-jobs
relations:
- - grafana:grafana-dashboard
  - cos-configuration-ceph:grafana-dashboards
- - prometheus:metrics-endpoint
  - cos-configuration-ceph:prometheus-config
- - prometheus:metrics-endpoint
  - prometheus-scrape-config-ceph:metrics-endpoint
