series: jammy
applications:
  ceph-dashboard:
    #charm: ceph-dashboard
    #channel: quincy/stable
    # LP: #2039763
    # LP: #2040022
    charm: ./ceph-dashboard_ubuntu-20.04-amd64.charm
  ceph-loadbalancer:
    charm: openstack-loadbalancer
    channel: jammy/stable
    num_units: 1
    to:
    - lxd:1
    options:
      vip: 192.168.151.51  # LP: #2039678
  ceph-mon:
    charm: ceph-mon
    channel: quincy/stable
    num_units: 3
    to:
    - lxd:0
    - lxd:1
    - lxd:2
    options:
      # LP: #1929262
      config-flags: '{"mon":{"auth allow insecure global id reclaim":"false"}}'
      expected-osd-count: 3
      monitor-count: 3
      source: distro
  ceph-osd:
    #charm: ceph-osd
    #channel: quincy/stable
    # LP: #2031637
    charm: ./charm-ceph-osd
    num_units: 3
    to:
    - "0"
    - "1"
    - "2"
    options:
      aa-profile-mode: complain  # LP: #2031637
      osd-devices: /dev/sdb /dev/vdb /dev/nvme0n1
      source: distro
  ceph-radosgw:
    charm: ceph-radosgw
    channel: quincy/stable
    num_units: 1
    to:
    - lxd:0
    options:
      source: distro
  ntp:
    charm: ntp
    channel: stable
  vault:
    charm: vault
    channel: 1.8/stable
    num_units: 1
    to:
    - lxd:2
machines:
  "0": {}
  "1": {}
  "2": {}
relations:
- - ceph-osd:mon
  - ceph-mon:osd
- - ntp:juju-info
  - ceph-osd:juju-info
- - ceph-radosgw:mon
  - ceph-mon:radosgw
- - vault:certificates
  - ceph-radosgw:certificates
- - ceph-dashboard:dashboard
  - ceph-mon:dashboard
- - ceph-dashboard:certificates
  - vault:certificates
- - ceph-dashboard:loadbalancer
  - ceph-loadbalancer:loadbalancer
# LP: #1986593
#- - ceph-dashboard:radosgw-dashboard
#  - ceph-radosgw:radosgw-user
